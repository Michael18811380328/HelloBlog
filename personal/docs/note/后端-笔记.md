# 后端笔记 
 
## 0061 如何实现 token 加密


1、JWT 加密

2、设置过期时间，避免客户端泄露 token 



   
## 0111 有没有使用过爬虫？具体的原理是什么


个人小项目中使用过简单的 python 爬虫（太极拳排名、静态小说等非登录认证的静态网页，且没有加密）

有一个静态页面的投票网站，我们需要获取不同人员的投票数，然后进行分析，找出最大值，中值，平均值等数据（复杂分析暂时不会）

基本思路：

1、使用 request 库模拟请求，浏览器返回 HTML 结果

2、使用 BS4 库处理爬取的 HTML，把字符串转换数据结构，并找到需要的标签（例如 script li 等）

3、数据处理（求最值，求平均值等），使用 io 模块写入本地的 txt 文件（如果是复杂的文件，可能使用 excel 或者 spss 软件进行数据分析，这是后续的过程）

前端的反思：反爬虫策略，1、增加登录验证，减少对静态界面爬取。2、使用 canvas img 等复杂元素节点，例如百度文库，这个给爬虫后续处理增加难度。3、文本编辑时，界面添加很多脏文本，就是不显示在界面上的特殊符号，然后被后端爬取到。或者 HTML 文本先加密，然后 JS 代码进行解密。这个在很多购物网站中使用，例如美团。

```python
# 请求库
import requests

# 解析库
from bs4 import BeautifulSoup

# 用于解决爬取的数据格式化
import io
import sys

# 设置爬取的默认字符编码
reload(sys)
sys.setdefaultencoding('utf8')

# 爬取的网页链接
r= requests.get("http://jsqg.sports.cn/index.php?s=/home/index/index/p/1.html")

# 中文显示
r.encoding='utf-8'
r.encoding=None
result = r.text

# 再次封装，获取具体标签内的内容
bs = BeautifulSoup(result,'html.parser')

# 具体标签
print("解析后的数据")
# print(bs.span)
a={}
# 获取已爬取内容中的script标签内容
data=bs.find_all('script')
# 获取已爬取内容中的td标签内容
data1=bs.find_all('li')

# 将爬取后的数据写入文件
filename = 'test_text.txt'
with open(filename, 'w') as file_object:
    for j in data1:
        file_object.write("%s\n" % (j.text))

```



   
## 0113 数据库事务处理是什么


事务处理是数据库中的术语：某一组操作是一个原子操作，如果中途无法执行，就回退到开始的状态。不能执行到一半执行停止执行。

实例：删除一个用户时，用户的各种信息分别在不同的表中存储，那么这组操作就包括多个删除 SQL 语句，就是一个 commit。例如删除用户的基本信息，用户的评论，用户的操作日志等。如果删除用户评论时，发现找不到这个用户，那么应该提示错误并回退到之前的状态，而不应该继续执行，或者执行一半。

```sql
START TRANSATION
DELETE FROM USERS WHERE user_id = 002;
DELETE FROM COMMENTS WHERE user_id = 002;
DELETE FROM OPERATIONS WHERE user_id = 002;
COMMIT;

```



   
## 0136 你对后端有哪些了解


定位：前端为主，了解一些简单的后端知识

知识点概念层面：RestFul API Graph 设计 API 的理念；请求并发，jwt token 验证，nginx 的反向代理，docker K8s 的基本使用（image container 实际运行环境等）权限控制

语言框架层面：Python django 和 flask，node 的 express 和 Koa 基本使用；mysql 关系型数据库的增删改查（redis mongoDB 非关系型数据库的概念）监听 URL

实际案例：以小说阅读器为例，用户注册，用户登录流程（服务器和客户端通信过程，HTTP 三次握手四次挥手 TCP get post 对应不同的 TCP 请求等，滑动窗口算法），管理员权限判断等；大文件断点续传；operations 的广播 socket WS 协议基本应用；单点登录等后端实现（session）



   
## 0150 python 字符串拼接变量语法


非重点

默认模板字符串，这样可以很好的说明变量的数据类型（类似C语言写法）

```
name = 'Mike'
age = 20

print("%s is good, he is %d score" % (name, age))

```

还有一个 f 字符串（类似JS模板字符串）

```
print(f"Hello, {first_name} {last_name}")

```



   
## 0205 Python 序列解包


序列解包是 python3 的语法糖，可以批量进行复制或者解包

参考链接：<https://blog.csdn.net/yilovexing/article/details/80576788>

本质上，python 变量存储的不是值，而是内存地址。这个操作是把引用的内存地址直接交换。

```python
# 简单赋值
x, y = 1, 2

# x, y 调换顺序
x, y = y, x

# 斐波那契数列中求和
x, y = y, x + y

# 获取剩余部分（*表示）
x, y, *z = 1, 2, 3, 4, 5 # z [3, 4, 5]
x, *y, z = 1, 2, 3, 4, 5 # y [2, 3, 4]
x, *y, z = 1, 2 # x 是1，z 是2， y是空列表

```

复杂情况

```python
(a, b), (c, d) = (1, 2), (3, 4)

s = 'ABCDEFG'
while s:
  x, *s = s
  print(x, s)
  
# result 
A ['B', 'C', 'D', 'E', 'F', 'G', 'H']
B ['C', 'D', 'E', 'F', 'G', 'H']
C ['D', 'E', 'F', 'G', 'H']
D ['E', 'F', 'G', 'H']
E ['F', 'G', 'H']
F ['G', 'H']
G ['H']
H []

```



   
## 0212 Restful API 与 GraphQL


简单和同事分享了两种网络技术协议，REST API 和 GraphQL。

restfulAPI 是早期的协议。在网络请求中，url 中表示请求的资源名称，请求的方法对应数据库的增删改查操作（回想一下常见的四种请求方法，get post delete put 的特点，以及 head option 请求方法）。这样的好处是 URL 直接关注资源，不需要关注怎么操作资源，目前项目大部分使用这个协议。



GraphQL是新一代的协议。每一个请求都类似 POST 请求，前端把需要的参数通过 POST 类似 JSON 发给后端，然后后端根据需要的参数返回给前端（后端需要查询）。好处：URL固定的，不会频繁变化。很多资源可以在一个 Query 中获取，这样服务器并行请求压力较小。服务器无需返回不需要的字段（前端需要用户姓名，后端会查询一次数据库，把用户很多信息拿到并返回）。这个也有不足，需要设置很多的查询和错误处理（前端查询两个参数，一个出错，怎么返回；数据量较大，传输更加消耗时间——网络良好的情况下不需要考虑这个）。



   
## 0213 vps 云服务器 物理服务器 的区别


物理服务器：真实的服务器，用于大企业，可靠性比较高，需要专人维护。内部维护比较安全稳定（例如金融电力通信行业）。



vps: Virtual Private Server（虚拟私有服务器），一般架设在云端，有固定的带宽，个人博客可以搭建在这里。企业的网站不适宜搭建。



云服务器：是 vps 的加强版，带宽可变，国内主要是华为云，阿里云，国外是亚马逊。



   
## 0214 docker 和 K8S 的关系


docker 和 K8S 的关系：docker and kubernetes

#### Docker

Docker 是轻量级的环境部署工具，相对传统虚拟机，占用资源少，可以提供若干个独立的环境部署不同的服务，架构是 image-container 从镜像创建不同的容器，然后在容器中执行操作，创建服务。不同容器共用底层硬件资源，数据层不互相影响。

image: 镜像（类）

container: 容器（类的实例）

docker 只适用于单机部署环境，对于集群部署服务，文件管理等需要下面的 k8s.

![](https://cloud.seatable.cn/workspace/32/asset/37d9be94-36c7-4add-8e78-fdf8564d701b/images/auto-upload/image-1673947884286.jpeg)

![](https://cloud.seatable.cn/workspace/32/asset/37d9be94-36c7-4add-8e78-fdf8564d701b/images/auto-upload/image-1673947892816.jpeg)

#### k8s

k8s 是一个集群环境-cluster，包括一个 Master 主节点和很多 Node 工作节点。

Master 主节点：负责调度管理不同的 Node 节点，提供了对外的接口 API，对内的控制器 Controller，Node 节点之间的调度，以及 etcd 存储系统。

Node 工作节点：每一个工作节点，运行了 Docker 创建容器的工具，创建了多个 POD 进程（独立的服务）还有其他的支持模块，例如 proxy 代理，日志模块，搜索模块等。

![](https://cloud.seatable.cn/workspace/32/asset/37d9be94-36c7-4add-8e78-fdf8564d701b/images/auto-upload/image-1673946428894.jpg)

![](https://cloud.seatable.cn/workspace/32/asset/37d9be94-36c7-4add-8e78-fdf8564d701b/images/auto-upload/image-1673946438393.jpg)

参考链接

<https://juejin.cn/post/6952331691524358174>

<https://juejin.cn/post/6844903943051411469>

<https://zhuanlan.zhihu.com/p/53260098>



   
## 0273 VNC 连接


<https://blog.csdn.net/jks212454/article/details/131453847> 

VNC (Virtual Network Console)是虚拟网络控制台的缩写。它 是一款优秀的远程控制工具软件，可以实现远程控制计算机的功能。

应用于云服务器控制平台，便于远程操作。



   
## 0283 python 字符串 strip lstrip rstrip 用法


a.strip()

把字符串左右两侧的某个字符串去掉。不传参，默认去掉的是空格和换行符；传参，去掉的是传递的子字符串。

```python
a = ' Hello Blog Mike!'
a.strip()
a.strip('!')

```

a.lstrip()

a.rstrip()

分别表示从左边和右边去掉特定字符串，加入参数类似效果

```
a.lstrip()
a.rstrip()

```



   
## 0284 python 字符串 replace 用法




```python
str = 'Hello Tony! Hello Mike!'
str.replace('Hello', 'Hi', 1)

```

第一个参数是需要替换的字符串

第二个参数是新的字符串

第三个参数（可选）是替换的次数，默认是全部替换



   
## 0296 MYSQL 高并发性能问题


Mysql 高并发性能问题，后端需要考虑的，前端了解即可。

问题：mysql 分布式还不完善，所以存在高并发的问题。如果并行请求很多，mysql 锁无法合理分配资源，产生延时。

解决

1、分库分表：利用已有的MySQL资源，将原来的数据表拆分成多个数据库（或者表），同时支持多个SQL的查询，可以在一定程度上提升查询性能。

2、缓存技术：使用缓存可以减少MySQL服务器的查询压力，提高数据的读取速度，降低内存的占用。常用的缓存技术有Redis、Memcache等，可以将MySQL查询和处理的结果缓存起来，实现简单的数据一次查询，多次引用的功能。

3、HTTP集群：通过市面上常用的反向代理负载均衡技术，将网站服务器的查询压力分散到多台服务器上，从而提升MySQL的性能和容量。

4、优化SQL语句：通过在查询语句中添加索引、减少冗余数据等步骤，提升表之间关联查询、语句执行速度以及内存容量。

参考链接

<https://www.dbs724.com/157170.html> 

<https://blog.csdn.net/weixin_40990818/article/details/113704102> 

<https://juejin.cn/post/7163894728201601060> 



   
## 0297 python reload 函数


reload 函数

作用：重新载入之前载入的模块

参考链接：<https://www.runoob.com/python/python-func-reload.html> 

不同版本下使用不同，最新的 3.4 版本的语法，实际案例

```python
# 重新载入 sys 模块

import sys

import importlib

importlib.reload(sys)

```



   
## 0298 python 中 self 是什么






self 是在为 class 编写 instance method 的时候，放在变量名第一个位子的占位词。

在具体编写 instance method 里，可以不使用 self 这个变量。

如果在 method 里面要改变 instance 的属性，可以用 self.xxxx 来指代这个属性进行修改。

所以self， 就是指由这个 class 造出来的 instance。

> 类似 JS 中 class 中的 this，指向类的实例

小结：class 表示类，类中的函数 function 就是方法 method，函数的第一个参数是 self，表示类的实例对象。



   
## 0328 django 中 skip_common_chunks


<https://www.5axxw.com/wiki/content/jxx937>

一个页面中，render\_bundle 如果调用多次，那么会将 common.css 和 common.js 多次插入到页面中

```
{% render_bundle 'viewDataGrid' 'css' %}
{% render_bundle 'baseStatistic' 'css' %}

{% render_bundle 'viewDataGrid' 'js' %}
{% render_bundle 'baseStatistic' 'js' %}

```

`SKIP_COMMON_CHUNKS`是一个标志，用于防止已生成的块再次包含在同一页面中。只有在每个Django模板使用多个入口点（多个`render_bundle`调用）时，才会发生这种情况。通过启用它，您可以获得与HtmlWebpackPlugin相同的默认行为。当在`render_bundle`上使用`skip_common_chunks`时，同样的注意事项也适用，有关更多详细信息，请参阅下面的部分。

```
{% render_bundle 'viewDataGrid' 'css' %}
{% render_bundle 'baseStatistic' 'css' skip_common_chunks=True %}

{% render_bundle 'viewDataGrid' 'js' %}
{% render_bundle 'baseStatistic' 'js' skip_common_chunks=True %}

```


   
## 0329 django 中 render_bundle


render_bundle 是一个 Django 模板标签，用于在模板中引入Webpack打包的静态资源文件。它是通过webpack_loader库提供的功能来实现的。

在给定的引用中，render_bundle被用来引入名为’main’的Webpack打包文件。它接受三个参数：**bundle名称、文件后缀和位置**。在这个例子中，'main’是bundle名称，'head.js’和’body.js’是文件后缀，'DEFAULT’是位置。

在模板中，render_bundle标签被用在\<head>和\<body>标签中，分别引入了’main.head.js’和’main.body.js’这两个Webpack打包的文件。

下面是一个示例，演示了如何使用render_bundle标签引入Webpack打包的静态资源文件：

```html
{% load render_bundle from webpack_loader %}

<html>
<head>
    {% render_bundle 'main' 'head.js' 'DEFAULT' %}
</head>
<body>
    ...
    {% render_bundle 'main' 'body.js' 'DEFAULT' %}
</body>
</html>

```



   
## 0377 mysql 中主键外键是什么？怎么使用？


mysql 中不同表通过主键和外键建立关联，进行约束，确保了数据一致性。

根据不同表的关联关系，确定主键和外键。

如果是一对多的关系（例如用户表和评论表），那么用户表的 id 就是主键，在评论表中建立 user_id 作为外键。

如果是多对多的关系（例如用户表和图书表），那么需要新建一个中间表，user_book 存放外键。用户表中 id 是主键，图书表中 id 也是主键，user_book 表中，新建 book_id 和 user_id 作为外键，进行关联和约束。

主键是唯一的，确保了数据增删改的联动性。



   
## 0378 mysql 中如何使用算法优化？


mysql 初级使用不涉及复杂算法

如果遇到慢查询时：mysql 建立索引时，实际上就是线性查找转换成映射查找（不同索引可能算法不一样），可以提高查询的速度。



   
## 0380 mysql 和 mariaDB 的区别是？


<https://blog.csdn.net/sensor_WU/article/details/129646422> 

相同点：mysql 和 mariaDB 都是关系型数据库，主要功能相同。MariaDB是MySQL的一个分支，由开源社区维护，采用GPL授权许可,完全兼容MySQL。

发展历史：mysql 早期是个人开发者发布，随后被 Sun 收购，随后 2008 年被 Oracle 收购，走上了商业化道路（收费）。2009年 mysql 创始人在新的分支上创建了 mariaDB，使用 GPL 许可证，代码开源。

主要区别：mysql 存储引擎是 innoDB, mariaDB 存储引擎是 XtraDB，有一些性能差异。



   
## 0408 PYTHON 系列教程


[https://www.liaoxuefeng.com/wiki/1016959663602400](https://www.liaoxuefeng.com/wiki/1016959663602400 "https://www.liaoxuefeng.com/wiki/1016959663602400")

整体写的适合自己，未来有机会学习，主要是平时多用

  